Add-PSSnapin VMware.VimAutomation.Core
Connect-VIServer 10.0.11.179

$vmlist = get-vm -Location Production_Test

$Report =@()
    foreach ($vm in $vmlist) {
        $row = "" | Select Name, IP, Notes, Key, Value, Key1, Value1, Key2, Value2
        $row.name = $vm.Name
        $row.IP = $vm.Guest.IPAddress[0]
        $row.Notes = $vm | select -ExpandProperty Notes
        $customattribs = $vm | select -ExpandProperty CustomFields
        $row.Key = $customattribs[0].Key
        $row.Value = $customattribs[0].value
        $row.Key1 = $customattribs[1].Key
        $row.Value1 = $customattribs[1].value    
        $row.Key2 = $customattribs[2].Key
        $row.Value2 = $customattribs[2].value        
	$Report += $row
    }

$Report | Export-Csv "c:\vms-with-notes-and-attributes.csv" -NoTypeInformation -UseCulture